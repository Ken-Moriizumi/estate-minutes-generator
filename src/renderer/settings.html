<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; style-src 'self' 'unsafe-inline'; script-src 'self'">
    <title>設定 - 議事録自動生成ツール</title>
    <link rel="stylesheet" href="css/settings.css">
</head>
<body>
    <div class="settings-container">
        <!-- サイドバー -->
        <aside class="sidebar">
            <h2 class="sidebar-title">設定</h2>
            <nav class="sidebar-nav">
                <a href="#basic" class="nav-item active" data-section="basic">
                    <span class="nav-icon">⚙️</span>
                    <span>基本設定</span>
                </a>
                <a href="#google" class="nav-item" data-section="google">
                    <span class="nav-icon">🔗</span>
                    <span>Google連携</span>
                </a>
                <a href="#participants" class="nav-item" data-section="participants">
                    <span class="nav-icon">👥</span>
                    <span>参加者情報</span>
                </a>
                <a href="#youtube" class="nav-item disabled" data-section="youtube">
                    <span class="nav-icon">📺</span>
                    <span>YouTube設定</span>
                    <span class="phase-badge phase-2">Phase 2</span>
                </a>
                <a href="#rakumachi" class="nav-item disabled" data-section="rakumachi">
                    <span class="nav-icon">🏢</span>
                    <span>楽待設定</span>
                    <span class="phase-badge phase-2">Phase 2</span>
                </a>
            </nav>
        </aside>

        <!-- メインコンテンツ -->
        <main class="main-content">
            <!-- 基本設定 -->
            <section id="basic" class="settings-section active">
                <h2 class="section-title">基本設定</h2>

                <div class="settings-card">
                    <h3 class="card-title">会社情報</h3>
                    <div class="form-group">
                        <label for="companyName" class="form-label">会社名</label>
                        <input type="text" id="companyName" class="form-input" placeholder="株式会社〇〇〇〇">
                    </div>
                </div>

                <div class="settings-card">
                    <h3 class="card-title">デフォルト設定</h3>
                    <div class="form-group">
                        <label for="defaultLocation" class="form-label">デフォルト開催場所</label>
                        <select id="defaultLocation" class="form-select">
                            <option value="tokyo">東京事務所</option>
                            <option value="nagano">長野事務所</option>
                            <option value="online">オンライン</option>
                        </select>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="defaultStartTime" class="form-label">デフォルト開始時刻</label>
                            <input type="time" id="defaultStartTime" class="form-input" value="14:00">
                        </div>
                        <div class="form-group">
                            <label for="defaultEndTime" class="form-label">デフォルト終了時刻</label>
                            <input type="time" id="defaultEndTime" class="form-input" value="15:00">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="retrievalPeriod" class="form-label">Gmail取得期間（日）</label>
                        <input type="number" id="retrievalPeriod" class="form-input" value="1" min="1" max="30">
                        <p class="form-hint">議事録生成時のデフォルトのメール取得期間</p>
                    </div>
                </div>
            </section>

            <!-- Google連携 -->
            <section id="google" class="settings-section">
                <h2 class="section-title">Google連携</h2>

                <div class="settings-card">
                    <h3 class="card-title">Google アカウント</h3>
                    <div class="auth-status" id="authStatus">
                        <div class="status-icon disconnected">●</div>
                        <div class="status-text">
                            <p class="status-label">未接続</p>
                            <p class="status-description">Googleアカウントと連携していません</p>
                        </div>
                    </div>
                    <div class="auth-actions">
                        <button class="btn btn-primary" id="authBtn">
                            Googleアカウントと連携
                        </button>
                        <button class="btn btn-secondary" id="clearAuthBtn" style="display: none;">
                            認証を解除
                        </button>
                    </div>
                    <div class="auth-code-section" id="authCodeSection" style="display: none;">
                        <p class="info-text">ブラウザで認証を完了したら、認証コードを下記に入力してください</p>
                        <div class="form-group">
                            <label for="authCode" class="form-label">認証コード</label>
                            <input type="text" id="authCode" class="form-input" placeholder="認証コードを貼り付けてください">
                        </div>
                        <button class="btn btn-primary" id="submitAuthCodeBtn">
                            認証コードを送信
                        </button>
                    </div>
                </div>

                <div class="settings-card">
                    <h3 class="card-title">Gmail設定</h3>
                    <div class="form-group">
                        <label for="gmailLabel" class="form-label">物件情報メールのラベル</label>
                        <select id="gmailLabel" class="form-select">
                            <option value="">ラベルを選択してください</option>
                        </select>
                        <p class="form-hint">このラベルが付いたメールから物件情報を取得します</p>
                    </div>
                    <div class="form-group">
                        <button class="btn btn-secondary" id="testGmailBtn">Gmail接続をテスト</button>
                    </div>
                    <div id="gmailTestResults" style="display: none; margin-top: 16px; padding: 12px; background: #f5f5f5; border-radius: 4px;">
                        <h4 style="margin: 0 0 8px 0; font-size: 14px; font-weight: 600;">テスト結果</h4>
                        <div id="gmailTestContent" style="font-size: 13px; line-height: 1.6;"></div>
                    </div>
                </div>

                <div class="settings-card">
                    <h3 class="card-title">Gemini API テスト</h3>
                    <p class="card-description">Gmail接続テストで取得したメールを使用して、Gemini APIで議事録生成をテストします</p>
                    <div class="form-group">
                        <button class="btn btn-secondary" id="testGeminiBtn">Gemini APIをテスト</button>
                    </div>
                    <div id="geminiTestResults" style="display: none; margin-top: 16px;">
                        <h4 style="margin: 0 0 8px 0; font-size: 14px; font-weight: 600;">生成された議事録</h4>
                        <textarea id="geminiTestContent" readonly style="width: 100%; min-height: 400px; padding: 12px; font-family: 'MS Gothic', monospace; font-size: 13px; line-height: 1.8; border: 1px solid #ddd; border-radius: 4px; background: #f9f9f9; resize: vertical;"></textarea>
                        <p class="form-hint" style="margin-top: 8px;">生成された議事録の内容を確認できます。プロンプトの調整が必要な場合は prompts/*.md ファイルを編集してください。</p>
                    </div>
                </div>

                <div class="settings-card">
                    <h3 class="card-title">Google Drive設定</h3>
                    <div class="form-group">
                        <label class="form-label">保存先フォルダ</label>
                        <div id="selectedFolderPath" style="padding: 12px; background: #f5f5f5; border-radius: 4px; margin-bottom: 12px; font-size: 14px; color: #333;">
                            <span id="folderPathText">マイドライブ</span>
                        </div>
                        <button class="btn btn-secondary" id="browseFolderBtn">フォルダを選択</button>
                        <p class="form-hint">議事録を保存するGoogle Driveのフォルダを選択します</p>
                    </div>

                    <!-- フォルダブラウザ（デフォルトは非表示） -->
                    <div id="folderBrowser" style="display: none; margin-top: 20px; padding: 16px; background: #fafafa; border: 1px solid #ddd; border-radius: 6px;">
                        <h4 style="margin: 0 0 12px 0; font-size: 15px; font-weight: 600;">フォルダを選択</h4>

                        <!-- パンくずリスト -->
                        <div id="breadcrumb" style="margin-bottom: 12px; padding: 8px 12px; background: white; border-radius: 4px; font-size: 13px; color: #666;">
                            📂 <span id="breadcrumbText">マイドライブ</span>
                        </div>

                        <!-- フォルダ一覧 -->
                        <div id="folderList" style="max-height: 300px; overflow-y: auto; background: white; border: 1px solid #ddd; border-radius: 4px; padding: 8px;">
                            <div style="padding: 20px; text-align: center; color: #999;">
                                読み込み中...
                            </div>
                        </div>

                        <!-- アクションボタン -->
                        <div style="margin-top: 12px; display: flex; gap: 8px; justify-content: flex-end;">
                            <button class="btn btn-secondary" id="selectCurrentFolderBtn">このフォルダを選択</button>
                            <button class="btn btn-secondary" id="cancelBrowseBtn">キャンセル</button>
                        </div>
                    </div>

                    <!-- Docs/Drive API テスト -->
                    <div class="form-group" style="margin-top: 20px;">
                        <button class="btn btn-secondary" id="testDocsDriveBtn">Docs/Drive APIをテスト</button>
                        <p class="form-hint">テスト議事録を作成して、選択したフォルダに保存します</p>
                    </div>
                </div>
            </section>

            <!-- 参加者情報 -->
            <section id="participants" class="settings-section">
                <h2 class="section-title">参加者情報</h2>

                <div class="settings-card">
                    <h3 class="card-title">役員情報</h3>
                    <div class="form-group">
                        <label for="presidentName" class="form-label">代表取締役社長</label>
                        <input type="text" id="presidentName" class="form-input" placeholder="山田太郎">
                    </div>
                    <div class="form-group">
                        <label for="wifeName" class="form-label">取締役（妻）</label>
                        <input type="text" id="wifeName" class="form-input" placeholder="山田花子">
                    </div>
                    <div class="form-group">
                        <label for="chairmanName" class="form-label">取締役会長（父）</label>
                        <input type="text" id="chairmanName" class="form-input" placeholder="山田一郎">
                    </div>
                    <div class="form-group">
                        <label for="motherName" class="form-label">取締役（母）</label>
                        <input type="text" id="motherName" class="form-input" placeholder="山田春子">
                    </div>
                    <div class="form-group">
                        <label for="sisterName" class="form-label">取締役（姉）</label>
                        <input type="text" id="sisterName" class="form-input" placeholder="山田美咲">
                    </div>
                </div>

                <div class="settings-card">
                    <h3 class="card-title">参加パターン設定</h3>
                    <p class="card-description">開催場所に応じた参加者の自動選択設定</p>

                    <div class="participation-pattern">
                        <h4>東京開催時</h4>
                        <div class="checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" checked disabled>
                                <span>代表取締役社長</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" checked disabled>
                                <span>取締役（妻）</span>
                            </label>
                        </div>
                    </div>

                    <div class="participation-pattern">
                        <h4>長野開催時</h4>
                        <div class="checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" checked disabled>
                                <span>取締役会長（父）</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" checked disabled>
                                <span>取締役（母）</span>
                            </label>
                        </div>
                    </div>
                </div>
            </section>

            <!-- YouTube設定 (Phase 2) -->
            <section id="youtube" class="settings-section">
                <div class="phase-notice">
                    <h3>Phase 2 で実装予定</h3>
                    <p>YouTube動画から税務情報を取得する機能は、Phase 2で追加される予定です。</p>
                </div>
            </section>

            <!-- 楽待設定 (Phase 2) -->
            <section id="rakumachi" class="settings-section">
                <div class="phase-notice">
                    <h3>Phase 2 で実装予定</h3>
                    <p>楽待ニュースから不動産情報を取得する機能は、Phase 2で追加される予定です。</p>
                </div>
            </section>

            <!-- 保存ボタン -->
            <div class="action-buttons">
                <button class="btn btn-secondary" id="cancelBtn">キャンセル</button>
                <button class="btn btn-primary" id="saveBtn">設定を保存</button>
            </div>
        </main>
    </div>

    <script src="../../dist/renderer/ts/settings.js"></script>
</body>
</html>